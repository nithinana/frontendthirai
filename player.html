<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Full Screen Embed Player</title>
    <style>
        /* Reset default browser margins/paddings */
        body, html {
            margin: 0;
            padding: 0;
            overflow: hidden; /* Prevent scrolling */
            height: 100%;
            width: 100%;
        }

        /* Styling for the iframe container and the iframe itself */
        #embed-container {
            width: 100vw;
            height: 100vh;
            display: flex;
            flex-direction: column; 
            justify-content: center;
            align-items: center;
            text-align: center; 
            color: #333; 
            font-family: sans-serif;
            padding: 20px;
            box-sizing: border-box; 
        }

        #movie-iframe {
            width: 100%;
            height: 100%;
            border: none; /* Remove the default iframe border */
        }
    </style>
</head>
<body>

    <div id="embed-container">
        <p>Loading content...</p>
    </div>

    <script>
        /**
         * JavaScript Logic to Extract Parameters and Create Embed
         */

        // 1. Define the base URLs for the embedding service
        const BASE_MOVIE_EMBED_URL = "https://www.vidking.net/embed/movie/";
        const BASE_TV_EMBED_URL = "https://www.vidking.net/embed/tv/";
        const TV_PREFIX = 'tv=';

        // 2. Function to handle errors
        function displayError(message) {
            const container = document.getElementById('embed-container');
            container.innerHTML = `<h1>Error: Missing or Invalid Data</h1><p>${message}</p>`;
            console.error(message);
        }

        // 3. Main execution function
        function loadEmbed() {
            // Get the raw query string, removing the leading '?'
            const queryString = window.location.search.substring(1);
            const container = document.getElementById('embed-container');
            let fullEmbedUrl = null;
            let contentType = null;

            if (!queryString) {
                // Handle the case where the ID is completely missing
                displayError('No ID provided in the URL. Please use: `?12345` for a movie or `?tv=12345/1/5` for a TV show.');
                return;
            }

            // --- Check for TV Show format ---
            if (queryString.startsWith(TV_PREFIX)) {
                contentType = 'TV Show';
                // Remove 'tv=' prefix to get the details string (e.g., '12345/1/5')
                const tvDetails = queryString.substring(TV_PREFIX.length); 
                
                // Split the details into [ID, Season, Episode]
                const parts = tvDetails.split('/'); 

                if (parts.length === 3) {
                    const [id, season, episode] = parts;
                    // Validate that ID, Season, and Episode are present (and maybe numeric)
                    if (id && season && episode) {
                        // Example: https://www.vidking.net/embed/tv/12345/1/5
                        fullEmbedUrl = `${BASE_TV_EMBED_URL}${id}/${season}/${episode}`;
                    }
                }

                if (!fullEmbedUrl) {
                    displayError('Invalid TV show format. Please use: `?tv=**ID/SEASON/EPISODE**`. Example: `?tv=12345/1/5`');
                }
            } 
            // --- Default to Movie format ---
            else {
                contentType = 'Movie';
                const movieId = queryString; // The whole string is the movie ID
                
                // We assume if it's not 'tv=', the rest is the Movie ID.
                if (movieId) {
                    // Example: https://www.vidking.net/embed/movie/12345
                    fullEmbedUrl = `${BASE_MOVIE_EMBED_URL}${movieId}`;
                } else {
                    // This case is unlikely to be hit due to the initial check, but kept for safety.
                    displayError('Movie ID is missing. Please use: `?**12345**`');
                }
            }

            // --- Create and append the iframe if a valid URL was constructed ---
            if (fullEmbedUrl) {
                // Create the new iframe element
                const iframe = document.createElement('iframe');
                iframe.setAttribute('id', 'movie-iframe');
                iframe.setAttribute('src', fullEmbedUrl);
                iframe.setAttribute('allowfullscreen', 'true');
                
                // Clear the container and append the iframe
                container.innerHTML = '';
                container.appendChild(iframe);

                console.log(`Successfully embedded ${contentType} from URL: ${fullEmbedUrl}`);
            }
        }

        // Run the main function once the page loads
        loadEmbed();
    </script>
</body>
</html>
