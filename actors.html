<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Thirai - Cast</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css"/>
    <style>
        /* --- CSS Variables for a Themed, Modern UI --- */
        :root {
            --bg-color: #f8f9fa;
            --text-color: #212529;
            --card-bg-color: #ffffff;
            --card-shadow: 0 4px 15px rgba(0, 0, 0, 0.07);
            --card-hover-shadow: 0 6px 20px rgba(0, 0, 0, 0.1);
            --border-color: #dee2e6;
            --primary-color: #007bff; /* Standard Blue */
            --primary-dark-color: #0056b3; /* Darker Blue for Active State */
            --primary-hover-color: #0056b3; 
            --header-bg: rgba(248, 249, 250, 0.85);
            --header-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
        }

        body.dark-mode {
            --bg-color: #121212;
            --text-color: #e0e0e0;
            --card-bg-color: #1e1e1e;
            --card-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
            --card-hover-shadow: 0 6px 20px rgba(0, 0, 0, 0.3);
            --border-color: #333;
            --primary-color: #3a8ee6; /* Lighter Blue for Dark Mode */
            --primary-dark-color: #1e6bbd; /* Darker Blue for Dark Mode Active State */
            --primary-hover-color: #1e6bbd;
            --header-bg: rgba(22, 22, 22, 0.85);
            --header-shadow: 0 2px 4px rgba(0, 0, 0, 0.4);
        }
        
        /* General Body Styles */
        body {
            background-color: var(--bg-color);
            color: var(--text-color);
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            transition: background-color 0.3s ease, color 0.3s ease; 
            overflow-x: hidden;
        }

        /* --- Header and Navigation --- */
        .app-header {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            z-index: 1030;
            padding: 1rem 1rem; 
            background-color: var(--header-bg);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border-bottom: 1px solid var(--border-color);
            box-shadow: var(--header-shadow);
            transition: background-color 0.3s ease, border-color 0.3s ease;
        }

        .header-logo {
            height: 30px; 
            width: auto;
        }
        
        .logo-wrapper { 
            display: flex;
            align-items: center;
        }
        
        /* Nav Links for Toggles (Actors/Actresses) */
        .header-center-nav {
            display: flex;
            align-items: center;
        }
        
        .nav-link {
            color: var(--text-color);
            font-weight: 500;
            padding: 0.5rem 1rem; 
            border-radius: 0.5rem;
            transition: background-color 0.2s ease, color 0.2s ease;
            text-decoration: none; 
            white-space: nowrap; 
        }

        .nav-link:hover {
            background-color: var(--card-bg-color);
        }

        .nav-link.active {
            color: var(--primary-color);
            font-weight: 600;
            background-color: transparent;
        }
        
        .nav-link.active:hover {
            background-color: var(--card-bg-color); 
        }
        
        body.dark-mode .nav-link:hover {
            background-color: rgba(255,255,255,0.05); 
        }
        
        /* --- Language Filter Styles (Sleek and Fixed) --- */
        #languageFilter {
            display: flex;
            /* Center the buttons within the container */
            justify-content: center; 
            overflow-x: auto; 
            padding: 10px 20px; 
            margin: 0 auto; 
            gap: 8px;
            width: 100%;
            max-width: 1200px; 
            box-sizing: border-box; 

            /* FIXED POSITIONING */
            position: fixed; 
            top: 60px; /* This value is dynamically set by JS */
            left: 0;
            right: 0; 
            z-index: 1000;
            background-color: var(--bg-color); 
            border-bottom: 1px solid var(--border-color);
            transition: background-color 0.3s ease, border-bottom-color 0.3s ease;
            
            /* Hide scrollbar */
            -ms-overflow-style: none;
            scrollbar-width: none;
        }
        #languageFilter::-webkit-scrollbar {
            display: none;
        }

        .language-filter-btn {
            background-color: transparent;
            border: 1px solid var(--border-color);
            color: var(--text-color);
            padding: 5px 12px;
            border-radius: 50rem; 
            font-size: 0.85rem;
            cursor: pointer;
            transition: background-color 0.2s ease, border-color 0.2s ease, color 0.2s ease;
            text-decoration: none;
            white-space: nowrap;
            flex-shrink: 0; 
        }

        .language-filter-btn:hover {
            background-color: var(--card-bg-color);
        }

        /* Highlighted/Active State: Darker Blue */
        .language-filter-btn.active {
            background-color: var(--primary-dark-color); /* Use darker blue */
            border-color: var(--primary-dark-color);
            color: white;
            font-weight: 600;
        }
        
        /* Main Content Area */
        .main-container {
            /* Margin set by JS to dynamically account for header + filter bar height */
            padding: 0 20px 20px 20px;
            width: 100%;
            max-width: 1200px;
            box-sizing: border-box;
            margin-left: auto;
            margin-right: auto;
        }
        
        /* Loading Message Style */
        .loading-message {
            grid-column: 1 / -1; 
            text-align: center;
            padding: 50px 0;
            font-size: 1.1rem;
            color: var(--text-color);
        }


        /* Cast Grid Styles */
        #castGrid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            gap: 20px;
        }

        .cast-card {
            background-color: var(--card-bg-color);
            border-radius: 10px;
            box-shadow: var(--card-shadow);
            text-align: center;
            text-decoration: none;
            color: inherit;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            transition: transform 0.2s ease, box-shadow 0.2s ease;
        }
        
        body.dark-mode .cast-card {
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.5);
        }

        .cast-card:hover {
            transform: translateY(-5px);
            box-shadow: var(--card-hover-shadow);
        }

        body.dark-mode .cast-card:hover {
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.6);
        }

        .cast-card img {
            width: 100%;
            height: auto;
            aspect-ratio: 2 / 3;
            object-fit: cover;
        }

        .cast-card .name {
            padding: 15px 10px;
            font-weight: 600;
            font-size: 0.9em;
            flex-grow: 1;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        /* --- Responsive Layout --- */
        @media (max-width: 768px) {
            .app-header .container-fluid {
                padding: 0.75rem 0.5rem; 
            }
            .header-center-nav {
                flex-grow: 1; 
                justify-content: center; 
            }
            .nav-link {
                padding: 0.5rem 0.6rem; 
                font-size: 0.85rem;
            }
            .main-container {
                padding: 0 15px 15px 15px; 
            }
            #languageFilter {
                padding: 10px 20px; /* FIX APPLIED: Increased horizontal padding for better mobile margins */
            }
            #castGrid {
                grid-template-columns: repeat(auto-fill, minmax(110px, 1fr));
                gap: 15px; 
            }
            .cast-card .name {
                padding: 8px 5px; 
                font-size: 0.8em; 
            }
        }
        
    </style>
</head>
<body>

    <header class="app-header">
        <div class="container-fluid d-flex align-items-center justify-content-between">
            
            <div class="logo-wrapper">
                <a id="logoLink" href="./index.html">
                    <img id="logo" src="./static/thiraiblack.png" alt="Thirai Logo" class="header-logo">
                </a>
            </div>
            
            <div class="d-flex align-items-center ms-auto">
                <div id="categoryNav" class="d-flex align-items-center gap-2 header-center-nav">
                    <a class="nav-link active" id="featuredBtn" href="#">Main</a>
                    <a class="nav-link" id="actorsBtn" href="#">Actors</a>
                    <a class="nav-link" id="actressesBtn" href="#">Actresses</a>
                </div>
            </div>
        </div>
    </header>

    <div id="languageFilter">
        </div>

    <main class="main-container">
        <div id="castGrid"></div>
    </main>
    
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            
            // --- START: JSON Data ---

            // Featured Cast Data
            const featuredActorsData = [
              { "name": "Vijay", "image_url": "https://sund-images.sunnxt.com/100587/250x375_Vijay_100587_224cc6a7-3c61-4e10-bde1-22dc80d0473b.jpg", "actor_code": "3TKYioHCAF" },
              { "name": "Dhanush", "image_url": "https://sund-images.sunnxt.com/101546/250x375_Dhanush_101546_2680c0f6-aa8e-4358-bcfd-a545c794f1f1.jpg", "actor_code": "5vCobOqDDx" },
              { "name": "Mohanlal", "image_url": "https://sund-images.sunnxt.com/101560/250x375_Mohanlal_101560_4a4618e2-faff-4156-bbfd-723f34346e06.jpg", "actor_code": "1Uv6Det8Ej" },
              { "name": "Mammootty", "image_url": "https://sund-images.sunnxt.com/101561/250x375_Mammootty_101561_0dd71a8d-9e60-4c77-86ef-bb773bc98038.jpg", "actor_code": "1WaoBhSG80" },
              { "name": "Vijay Sethupathi", "image_url": "https://sund-images.sunnxt.com/138708/250x375_VijaySethupathi_138708_d8b98537-1c46-4b2d-8d49-6a53594ee332.jpg", "actor_code": "1yADiX9kkO" },
              { "name": "Rajinikanth", "image_url": "https://sund-images.sunnxt.com/94511/250x375_Rajinikanth_94511_1202521b-b7e0-421b-80f2-ac5034a57930.jpg", "actor_code": "ijsq87BV3Y" },
              { "name": "Karthi Sivakumar", "image_url": "https://sund-images.sunnxt.com/101549/250x375_KarthiSivakumar_101549_dd816cb1-d07d-4190-a025-9f183f1f5075.jpg", "actor_code": "5mHRERsgQU" },
              { "name": "Sivakarthikeyan", "image_url": "https://sund-images.sunnxt.com/101548/250x375_Sivakarthikeyan_101548_969c4838-4b33-4b19-b2b0-76202e848226.jpg", "actor_code": "6ZDHHGuxxN" },
              { "name": "Suriya", "image_url": "https://sund-images.sunnxt.com/101545/250x375_Surya_101545_27017026-a6bd-43fa-a65d-e7fa86cd0528.jpg", "actor_code": "2waH3hTKAe" },
              { "name": "Vikram", "image_url": "https://sund-images.sunnxt.com/101544/250x375_Vikram_101544_d6dcb2fb-330f-4850-b748-d503d5241704.jpg", "actor_code": "5uf7csvvAf" },
              { "name": "Ajith Kumar", "image_url": "https://sund-images.sunnxt.com/101543/250x375_AjithKumar_101543_2a898516-1e0f-49f3-b570-8c5f4ecd8936.jpg", "actor_code": "4pDqQD0LPJ" },
              { "name": "Fahadh Fassil", "image_url": "https://sund-images.sunnxt.com/101565/250x375_FahadhFaasil_101565_18dbdffc-4760-419a-a24c-d4280c6fe684.jpg", "actor_code": "5rqK8kvM2U" },
              { "name": "Kamal Haasan", "image_url": "https://sund-images.sunnxt.com/101542/250x375_KamalHaasan_101542_13c3f9ea-ae22-4e5f-a49e-c0c709c2128f.jpg", "actor_code": "5Ix02sIDeA" },
              { "name": "Prithviraj", "image_url": "https://sund-images.sunnxt.com/101562/250x375_PrithvirajSukumaran_101562_7617b864-4396-476e-83aa-83c27978139a.jpg", "actor_code": "4n085rJr74" },
              { "name": "Vijayakanth", "image_url": "https://sund-images.sunnxt.com/101714/250x375_Vijayakanth_101714_108c0c0d-c124-43d5-8254-c83cb6a7a943.jpg", "actor_code": "8huiZv1bPB" },
              { "name": "Prabhas", "image_url": "https://sund-images.sunnxt.com/101553/250x375_Prabhas_101553_5043283d-4812-4d2e-84e8-43313c1622f6.jpg", "actor_code": "7IcT9rmeui" },
              { "name": "Nani", "image_url": "https://sund-images.sunnxt.com/101558/250x375_Nani_101558_bf4ca935-5d41-450d-b3e1-94e4faf5e4a9.jpg", "actor_code": "3isSF2aCCr" },
              { "name": "Prabhu", "image_url": "https://sund-images.sunnxt.com/101711/250x375_Prabhu_101711_2124675c-d79e-47c5-9ce4-2bdfffdc2a64.jpg", "actor_code": "5ycjeOX2Hm" }
            ];

            const featuredActressesData = [
              { "name": "Trisha Krishnan", "image_url": "https://sund-images.sunnxt.com/131408/250x375_TrishaKrishnan_131408_d8af3600-7fdd-4bc0-b723-4be0ced8f2e4.jpg", "actor_code": "F1cHse9jWW" },
              { "name": "Samantha", "image_url": "https://sund-images.sunnxt.com/131409/250x375_Samantha_131409_65c2f409-f020-4360-969a-b9f741232ccf.jpg", "actor_code": "6WfqAcxel5" },
              { "name": "Nayanthara", "image_url": "https://sund-images.sunnxt.com/131441/250x375_Nayanthara_131441_76f534d9-19d3-4a02-a01a-03669dcd21c1.jpg", "actor_code": "7tFt1Le1Ep" },
              { "name": "Pooja Hegde", "image_url": "https://sund-images.sunnxt.com/138711/250x375_PoojaHegde_138711_b484d386-2c3d-408b-89db-88177887ab8a.jpg", "actor_code": "14CoLSwEXV" },
              { "name": "Nithya Menen", "image_url": "https://sund-images.sunnxt.com/131443/250x375_NithyaMenen_131443_db5be06a-7a6a-4b30-80b4-380506464b56.jpg", "actor_code": "3AQ1iONzZQ" },
              { "name": "Anushka Shetty", "image_url": "https://sund-images.sunnxt.com/131445/250x375_AnushkaShetty_131445_df5b5e1e-50c3-4559-a946-1cb9ab77202e.jpg", "actor_code": "2ldhTbiGgU" },
              { "name": "Hansika Motwani", "image_url": "https://sund-images.sunnxt.com/131424/250x375_HansikaMotwani_131424_d6c17c92-d0b1-4600-b353-45c2c47d53fd.jpg", "actor_code": "3FGflYSCcj" },
              { "name": "Kajal Aggarwal", "image_url": "https://sund-images.sunnxt.com/131426/250x375_KajalAggarwal_131426_0ca0896b-bdef-4833-9dec-770e035b149c.jpg", "actor_code": "7GLAgNWiq2" },
              { "name": "Shruti Haasan", "image_url": "https://sund-images.sunnxt.com/131431/250x375_ShrutiHaasan_131431_78778c01-540b-4576-a883-699ec7224571.jpg", "actor_code": "7fCylLNfVi" },
              { "name": "Priyamani", "image_url": "https://sund-images.sunnxt.com/131415/250x375_Priyamani_131415_7a92265f-5432-4e9e-a38c-46e2200c522c.jpg", "actor_code": "1mh1dheOZR" },
              { "name": "Simran", "image_url": "https://sund-images.sunnxt.com/131407/250x375_Simran_131407_a9b95132-9205-420d-9f5f-9e6a8bba22e0.jpg", "actor_code": "33rNUL3JZx" },
              { "name": "Aishwarya Rajesh", "image_url": "https://sund-images.sunnxt.com/131411/250x375_AishwaryaRajesh_131411_c7758ce1-6327-41b1-bd5c-7f84ac947bf3.jpg", "actor_code": "CeT6162PqU" }
            ];

            const allFeaturedData = {
                'actors': featuredActorsData,
                'actresses': featuredActressesData
            };

            // TMDb Cast Data
            const actorsData = [
                // Tamil Actors
                { "name": "Vijay", "tmdb_id": "91547", "actor_code": "3TKYioHCAF", "language": "tamil" }, 
                { "name": "Dhanush", "tmdb_id": "550165", "actor_code": "5vCobOqDDx", "language": "tamil" }, 
                { "name": "Kamal Haasan", "tmdb_id": "93193", "actor_code": "5Ix02sIDeA", "language": "tamil" },
                { "name": "Vijay Sethupathi", "tmdb_id": "1123766", "actor_code": "1yADiX9kkO", "language": "tamil" }, 
                { "name": "Rajinikanth", "tmdb_id": "91555", "actor_code": "ijsq87BV3Y", "language": "tamil" },
                { "name": "Karthi Sivakumar", "tmdb_id": "123066", "actor_code": "5mHRERsgQU", "language": "tamil" },
                { "name": "Sivakarthikeyan", "tmdb_id": "587982", "actor_code": "6ZDHHGuxxN", "language": "tamil" },
                { "name": "Vishal", "tmdb_id": "559892", "actor_code": "1emttPrIgB", "language": "tamil" },
                { "name": "Suriya", "tmdb_id": "85720", "actor_code": "2waH3hTKAe", "language": "tamil" },
                { "name": "Vikram", "tmdb_id": "93191", "actor_code": "5uf7csvvAf", "language": "tamil" },
                { "name": "Ajith Kumar", "tmdb_id": "148360", "actor_code": "4pDqQD0LPJ", "language": "tamil" },
                 { "name": "Vadivelu", "tmdb_id": "91549", "actor_code": "1cSST4zk4I", "language": "tamil" }, 
                { "name": "Yogi Babu", "tmdb_id": "1540764", "actor_code": "H9Fx9P1JxP", "language": "tamil" }, 
                { "name": "Jayam Ravi", "tmdb_id": "237966", "actor_code": "5neYQbiTqu", "language": "tamil" }, 
                 { "name": "Arya", "tmdb_id": "130109", "actor_code": "33DEfO2wRC", "language": "tamil" },
                { "name": "Madhavan", "tmdb_id": "85519", "actor_code": "3vxJO7cuw1", "language": "tamil" },
                { "name": "STR", "tmdb_id": "222760", "actor_code": "2Qv5lafKhY", "language": "tamil" },
                { "name": "Siddharth", "tmdb_id": "108216", "actor_code": "69EME6TPQE", "language": "tamil" }, 
                { "name": "Soori", "tmdb_id": "544897", "actor_code": "523IeICZKh", "language": "tamil" },
                { "name": "Pradeep Ranganathan", "tmdb_id": "2274937", "actor_code": "19A9Wxsiru", "language": "tamil" },
                { "name": "M. G. Ramachandran", "tmdb_id": "584602", "actor_code": "8L6px81Vzd", "language": "tamil" },
                { "name": "Vijayakanth", "tmdb_id": "237635", "actor_code": "8huiZv1bPB", "language": "tamil" },
                { "name": "Prabhu", "tmdb_id": "85722", "actor_code": "5ycjeOX2Hm", "language": "tamil" },
                
                // Hindi Actors
                { "name": "Shah Rukh Khan", "tmdb_id": "35742", "actor_code": "b4tCNsNP3r", "language": "hindi" }, 
                { "name": "Ranbir Kapoor", "tmdb_id": "85034", "actor_code": "2cKAcgtako", "language": "hindi" }, 
                { "name": "Salman Khan", "tmdb_id": "42802", "actor_code": "73t49Zpm8Z", "language": "hindi" }, 
                { "name": "Sidharth Malhotra", "tmdb_id": "1108117", "actor_code": "2ZZHmp8rm2", "language": "hindi" }, 
                { "name": "Amitabh Bachchan", "tmdb_id": "35780", "actor_code": "2z1RmIZxHh", "language": "hindi" },
                { "name": "Hrithik Roshan", "tmdb_id": "78749", "actor_code": "pQrb67ZvoX", "language": "hindi" },
                { "name": "Aamir Khan", "tmdb_id": "52763", "actor_code": "7wg7uK17Bg", "language": "hindi" },
                
                // Malayalam Actors
                { "name": "Mohanlal", "tmdb_id": "82732", "actor_code": "1Uv6Det8Ej", "language": "malayalam" },   
                { "name": "Mammootty", "tmdb_id": "124111", "actor_code": "1WaoBhSG80", "language": "malayalam" }, 
                { "name": "Fahadh Fassil", "tmdb_id": "1072750", "actor_code": "5rqK8kvM2U", "language": "malayalam" },
                { "name": "Prithviraj", "tmdb_id": "117690", "actor_code": "4n085rJr74", "language": "malayalam" },
                
                // Telugu Actors
                { "name": "Prabhas", "tmdb_id": "237045", "actor_code": "7IcT9rmeui", "language": "telugu" },
                { "name": "Allu Arjun", "tmdb_id": "108215", "actor_code": "7ug2FmruQr", "language": "telugu" },
                { "name": "Nani", "tmdb_id": "225387", "actor_code": "3isSF2aCCr", "language": "telugu" }
            ];

            const actressesData = [
              // Actresses (assigned primary industry language)
              { "name": "Trisha Krishnan", "tmdb_id": "116925", "actor_code": "F1cHse9jWW", "language": "tamil" }, 
              { "name": "Samantha", "tmdb_id": "225312", "actor_code": "6WfqAcxel5", "language": "tamil" }, 
              { "name": "Asin", "tmdb_id": "81092", "actor_code": "F06ZXPJGJh", "language": "tamil" }, 
              { "name": "Nayanthara", "tmdb_id": "91548", "actor_code": "7tFt1Le1Ep", "language": "tamil" }, 
              { "name": "Pooja Hegde", "tmdb_id": "587753", "actor_code": "14CoLSwEXV", "language": "tamil" }, 
              { "name": "Alia Bhatt", "tmdb_id": "1108120", "actor_code": "4LJUx3vqDc", "language": "hindi" }, 
              { "name": "Nithya Menen", "tmdb_id": "225388", "actor_code": "3AQ1iONzZQ", "language": "tamil" }, 
                { "name": "Rashmika Mandanna", "tmdb_id": "1752056", "actor_code": "7wtbAiXAuP", "language": "tamil" }, 
              { "name": "Anushka Shetty", "tmdb_id": "88167", "actor_code": "2ldhTbiGgU", "language": "tamil" },
              { "name": "Hansika Motwani", "tmdb_id": "237967", "actor_code": "3FGflYSCcj", "language": "tamil" },
              { "name": "Kajal Aggarwal", "tmdb_id": "55061", "actor_code": "7GLAgNWiq2", "language": "hindi" },
              { "name": "Shruti Haasan", "tmdb_id": "85883", "actor_code": "7fCylLNfVi", "language": "tamil" },
              { "name": "Deepika Padukone", "tmdb_id": "53975", "actor_code": "7Iwku12HLv", "language": "hindi" },
              { "name": "Kareena Kapoor", "tmdb_id": "37233", "actor_code": "6cC1dMrY40", "language": "hindi" },
              { "name": "Priyamani", "tmdb_id": "1107197", "actor_code": "1mh1dheOZR", "language": "tamil" },
              { "name": "Simran", "tmdb_id": "141705", "actor_code": "33rNUL3JZx", "language": "tamil" },
              { "name": "Aishwarya Rajesh", "tmdb_id": "1114583", "actor_code": "CeT6162PqU", "language": "tamil" }
            ];
            
            // Global map for accessing TMDb data arrays
            const allCastData = {
                'actors': actorsData,
                'actresses': actressesData
            };
            
            // --- END: JSON Data ---

            // TMDb API Configuration
            const TMDB_API_KEY = '926e94b0f70b5bed8417b679652366ab';
            const TMDB_BASE_URL = 'https://api.themoviedb.org/3/person/';
            const TMDB_IMAGE_BASE_URL = 'https://image.tmdb.org/t/p/w185';
            
            // Element References
            const body = document.body;
            const logo = document.getElementById('logo');
            const castGrid = document.getElementById('castGrid');
            const actorsBtn = document.getElementById('actorsBtn');
            const actressesBtn = document.getElementById('actressesBtn');
            const featuredBtn = document.getElementById('featuredBtn');
            const logoLink = document.getElementById('logoLink');
            const languageFilterDiv = document.getElementById('languageFilter'); 

            // State Variables
            let currentViewMode = 'featured'; // 'featured' or 'tmdb'
            let currentCastType = 'actors'; 
            let activeLanguageFilter = 'all';
            let currentFeaturedType = 'actors';


            // --- Utility Functions ---

            function adjustBodyPadding() {
                const header = document.querySelector('.app-header');
                const filter = document.getElementById('languageFilter');
                
                if (header && filter) {
                    const headerHeight = header.offsetHeight;
                    const filterHeight = filter.offsetHeight;
                    
                    filter.style.top = `${headerHeight}px`;
                    const totalFixedHeight = headerHeight + filterHeight + 20; 
                    document.querySelector('.main-container').style.marginTop = `${totalFixedHeight}px`; 
                }
            }
            
            function updateThemeAssets(isDarkMode) {
                const lightLogo = './static/thiraiblack.png';
                const darkLogo = './static/thiraiwhite.png';
                logo.src = isDarkMode ? darkLogo : lightLogo;
            }

            function applyTheme(theme) {
                let isDarkMode;
                const storedTheme = localStorage.getItem('theme');

                if (theme === 'system' && storedTheme) {
                    theme = storedTheme;
                }
                
                if (theme === 'dark') {
                    body.classList.add('dark-mode');
                    isDarkMode = true;
                } else if (theme === 'light') {
                    body.classList.remove('dark-mode');
                    isDarkMode = false;
                } else {
                    isDarkMode = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
                    if (isDarkMode) body.classList.add('dark-mode');
                    else body.classList.remove('dark-mode');
                }
                updateThemeAssets(isDarkMode);
            }
            
            function getUniqueLanguages(data) {
                const languages = new Set();
                data.forEach(member => {
                    if (member.language) {
                        languages.add(member.language);
                    }
                });
                return Array.from(languages).sort();
            }

            function updateActiveFilterButton(language) {
                 document.querySelectorAll('.language-filter-btn').forEach(btn => {
                    btn.classList.remove('active');
                    if (btn.dataset.language === language) {
                        btn.classList.add('active');
                    }
                });
            }

            function createFeaturedFilter() {
                languageFilterDiv.innerHTML = ''; 

                const types = ['actors', 'actresses'];
                types.forEach(type => {
                    const capitalized = type.charAt(0).toUpperCase() + type.slice(1);
                    
                    const btn = document.createElement('a');
                    btn.className = 'language-filter-btn';
                    btn.href = '#';
                    btn.dataset.type = type;
                    btn.textContent = capitalized;
                    if (currentFeaturedType === type) {
                        btn.classList.add('active');
                    }
                    
                    languageFilterDiv.appendChild(btn);
                });

                document.querySelectorAll('#languageFilter .language-filter-btn').forEach(btn => {
                    btn.addEventListener('click', (event) => {
                        event.preventDefault();
                        const selectedType = event.currentTarget.dataset.type;
                        if (selectedType !== currentFeaturedType) {
                            currentFeaturedType = selectedType;
                            document.querySelectorAll('#languageFilter .language-filter-btn').forEach(b => b.classList.remove('active'));
                            event.currentTarget.classList.add('active');
                            displayFeaturedCast(selectedType); 
                        }
                    });
                });

                adjustBodyPadding();
            }
            
            function createLanguageFilter(castType) {
                languageFilterDiv.innerHTML = ''; 
                
                const availableLanguages = getUniqueLanguages(allCastData[castType]);

                const allBtn = document.createElement('a');
                allBtn.className = 'language-filter-btn';
                allBtn.href = '#';
                allBtn.dataset.language = 'all';
                allBtn.textContent = 'All';
                if (activeLanguageFilter === 'all') allBtn.classList.add('active');
                languageFilterDiv.appendChild(allBtn);

                availableLanguages.forEach(lang => {
                    const capitalized = lang.charAt(0).toUpperCase() + lang.slice(1);
                    const btn = document.createElement('a');
                    btn.className = 'language-filter-btn';
                    btn.href = '#';
                    btn.dataset.language = lang;
                    btn.textContent = capitalized;
                    if (activeLanguageFilter === lang) btn.classList.add('active');
                    languageFilterDiv.appendChild(btn);
                });

                document.querySelectorAll('.language-filter-btn').forEach(btn => {
                    btn.addEventListener('click', (event) => {
                        event.preventDefault();
                        const selectedLang = event.currentTarget.dataset.language;
                        if (selectedLang !== activeLanguageFilter) {
                            activeLanguageFilter = selectedLang;
                            updateActiveFilterButton(selectedLang);
                            displayCast(currentCastType, activeLanguageFilter); 
                        }
                    });
                });
                
                if (activeLanguageFilter !== 'all' && !availableLanguages.includes(activeLanguageFilter)) {
                    activeLanguageFilter = 'all';
                    updateActiveFilterButton('all');
                    displayCast(currentCastType, activeLanguageFilter);
                }
                
                adjustBodyPadding();
            }


            async function fetchProfileImageUrl(tmdbId) {
                const url = `${TMDB_BASE_URL}${tmdbId}?api_key=${TMDB_API_KEY}&append_to_response=images`;
                
                try {
                    const response = await fetch(url);
                    if (!response.ok) return null; 
                    const data = await response.json();
                    const profilePath = data.profile_path; 
                    return profilePath ? `${TMDB_IMAGE_BASE_URL}${profilePath}` : null;
                } catch (error) {
                    return null;
                }
            }

            function createCastCard(member, imageUrl) {
                 const card = document.createElement('a');
                 card.className = 'cast-card';
                 
                 const lang = member.language || 'tamil'; // Default language for featured cast link
                 card.href = `actor?lang=${lang}&actor_id=${member.actor_code}`; 

                 const img = document.createElement('img');
                 // Use direct image_url for featured cast, otherwise use fetched imageUrl
                 img.src = member.image_url || imageUrl || './static/placeholder.png'; 
                 img.alt = `Photo of ${member.name}`;
                 img.loading = 'lazy';
                 
                 img.onerror = function() {
                    this.onerror=null; 
                    this.src='./static/default_actor.png'; 
                 };

                 const name = document.createElement('div');
                 name.className = 'name';
                 name.textContent = member.name;
                 
                 card.appendChild(img);
                 card.appendChild(name);
                 
                 return card;
            }

            function displayFeaturedCast(featuredType) {
                castGrid.innerHTML = '';
                const castList = allFeaturedData[featuredType];

                if (castList.length === 0) {
                    castGrid.innerHTML = '<div class="loading-message">No featured members found.</div>';
                    return;
                }

                const fragment = document.createDocumentFragment();
                castList.forEach(member => {
                    const card = createCastCard(member);
                    fragment.appendChild(card);
                });

                castGrid.appendChild(fragment);
            }

            async function displayCast(castType, languageFilter) {
                castGrid.innerHTML = '<div class="loading-message"></div>';
                let castList = allCastData[castType];

                if (languageFilter && languageFilter !== 'all') {
                    castList = castList.filter(member => member.language === languageFilter);
                }

                if (castList.length === 0) {
                    castGrid.innerHTML = '<div class="loading-message">No cast members found for the selected filter.</div>';
                    return;
                }

                const fetchPromises = castList.map(member => 
                    fetchProfileImageUrl(member.tmdb_id).then(imageUrl => ({ member, imageUrl }))
                );

                const results = await Promise.all(fetchPromises);
                
                castGrid.innerHTML = ''; 
                const fragment = document.createDocumentFragment();
                results.forEach(result => {
                    const card = createCastCard(result.member, result.imageUrl);
                    fragment.appendChild(card);
                });
                castGrid.appendChild(fragment);
            }


            // --- Event Listeners for Toggle Buttons ---
            featuredBtn.addEventListener('click', (e) => {
                e.preventDefault();
                if (currentViewMode !== 'featured') {
                    currentViewMode = 'featured';
                    featuredBtn.classList.add('active');
                    actorsBtn.classList.remove('active');
                    actressesBtn.classList.remove('active');
                    createFeaturedFilter();
                    displayFeaturedCast(currentFeaturedType);
                }
            });

            actorsBtn.addEventListener('click', (event) => {
                event.preventDefault();
                if (currentViewMode !== 'tmdb' || currentCastType !== 'actors') {
                    currentViewMode = 'tmdb';
                    currentCastType = 'actors';
                    activeLanguageFilter = 'all';
                    actorsBtn.classList.add('active');
                    actressesBtn.classList.remove('active');
                    featuredBtn.classList.remove('active');
                    createLanguageFilter(currentCastType); 
                    displayCast(currentCastType, activeLanguageFilter);
                }
            });

            actressesBtn.addEventListener('click', (event) => {
                event.preventDefault();
                if (currentViewMode !== 'tmdb' || currentCastType !== 'actresses') {
                    currentViewMode = 'tmdb';
                    currentCastType = 'actresses';
                    activeLanguageFilter = 'all';
                    actressesBtn.classList.add('active');
                    actorsBtn.classList.remove('active');
                    featuredBtn.classList.remove('active');
                    createLanguageFilter(currentCastType); 
                    displayCast(currentCastType, activeLanguageFilter); 
                }
            });

            // --- Initialization ---
            
            const storedTheme = localStorage.getItem('theme') || 'system';
            applyTheme(storedTheme);
            
            if (window.matchMedia) {
                window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', event => {
                    if (!localStorage.getItem('theme')) applyTheme('system');
                });
            }

            // Load default view (Featured)
            createFeaturedFilter();
            displayFeaturedCast(currentFeaturedType); 
            
            adjustBodyPadding();
            window.addEventListener('resize', adjustBodyPadding);
        });
    </script>
</body>
</html>

