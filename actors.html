<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Thirai - Cast</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css"/>
    <style>
        /* --- CSS Variables for a Themed, Modern UI --- */
        :root {
            --bg-color: #f8f9fa;
            --text-color: #212529;
            --card-bg-color: #ffffff;
            --card-shadow: 0 4px 15px rgba(0, 0, 0, 0.07);
            --card-hover-shadow: 0 6px 20px rgba(0, 0, 0, 0.1);
            --border-color: #dee2e6;
            --primary-color: #007bff; /* Standard Blue */
            --primary-dark-color: #0056b3; /* Darker Blue for Active State */
            --primary-hover-color: #0056b3; 
            --header-bg: rgba(248, 249, 250, 0.85);
            --header-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
        }

        body.dark-mode {
            --bg-color: #121212;
            --text-color: #e0e0e0;
            --card-bg-color: #1e1e1e;
            --card-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
            --card-hover-shadow: 0 6px 20px rgba(0, 0, 0, 0.3);
            --border-color: #333;
            --primary-color: #3a8ee6; /* Lighter Blue for Dark Mode */
            --primary-dark-color: #1e6bbd; /* Darker Blue for Dark Mode Active State */
            --primary-hover-color: #1e6bbd;
            --header-bg: rgba(22, 22, 22, 0.85);
            --header-shadow: 0 2px 4px rgba(0, 0, 0, 0.4);
        }
        
        /* General Body Styles */
        body {
            background-color: var(--bg-color);
            color: var(--text-color);
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            transition: background-color 0.3s ease, color 0.3s ease; 
            overflow-x: hidden;
        }

        /* --- Header and Navigation --- */
        .app-header {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            z-index: 1030;
            padding: 1rem 1rem; 
            background-color: var(--header-bg);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border-bottom: 1px solid var(--border-color);
            box-shadow: var(--header-shadow);
            transition: background-color 0.3s ease, border-color 0.3s ease;
        }

        .header-logo {
            height: 30px; 
            width: auto;
        }
        
        .logo-wrapper { 
            display: flex;
            align-items: center;
        }
        
        /* Nav Links for Toggles (Actors/Actresses) */
        .header-center-nav {
            display: flex;
            align-items: center;
        }
        
        .nav-link {
            color: var(--text-color);
            font-weight: 500;
            padding: 0.5rem 1rem; 
            border-radius: 0.5rem;
            transition: background-color 0.2s ease, color 0.2s ease;
            text-decoration: none; 
            white-space: nowrap; 
        }

        .nav-link:hover {
            background-color: var(--card-bg-color);
        }

        .nav-link.active {
            color: var(--primary-color);
            font-weight: 600;
            background-color: transparent;
        }
        
        .nav-link.active:hover {
            background-color: var(--card-bg-color); 
        }
        
        body.dark-mode .nav-link:hover {
            background-color: rgba(255,255,255,0.05); 
        }
        
        /* --- Language Filter Styles (Sleek and Fixed) --- */
        #languageFilter {
            display: flex;
            /* Center the buttons within the container */
            justify-content: center; 
            overflow-x: auto; 
            padding: 10px 20px; 
            margin: 0 auto; 
            gap: 8px;
            width: 100%;
            max-width: 1200px; 
            box-sizing: border-box; 

            /* FIXED POSITIONING */
            position: fixed; 
            top: 60px; /* This value is dynamically set by JS */
            left: 0;
            right: 0; 
            z-index: 1000;
            background-color: var(--bg-color); 
            border-bottom: 1px solid var(--border-color);
            transition: background-color 0.3s ease, border-bottom-color 0.3s ease;
            
            /* Hide scrollbar */
            -ms-overflow-style: none;
            scrollbar-width: none;
        }
        #languageFilter::-webkit-scrollbar {
            display: none;
        }

        .language-filter-btn {
            background-color: transparent;
            border: 1px solid var(--border-color);
            color: var(--text-color);
            padding: 5px 12px;
            border-radius: 50rem; 
            font-size: 0.85rem;
            cursor: pointer;
            transition: background-color 0.2s ease, border-color 0.2s ease, color 0.2s ease;
            text-decoration: none;
            white-space: nowrap;
            flex-shrink: 0; 
        }

        .language-filter-btn:hover {
            background-color: var(--card-bg-color);
        }

        /* Highlighted/Active State: Darker Blue */
        .language-filter-btn.active {
            background-color: var(--primary-dark-color); /* Use darker blue */
            border-color: var(--primary-dark-color);
            color: white;
            font-weight: 600;
        }
        
        /* Main Content Area */
        .main-container {
            /* Margin set by JS to dynamically account for header + filter bar height */
            padding: 0 20px 20px 20px;
            width: 100%;
            max-width: 1200px;
            box-sizing: border-box;
            margin-left: auto;
            margin-right: auto;
        }
        
        /* Loading Message Style */
        .loading-message {
            grid-column: 1 / -1; 
            text-align: center;
            padding: 50px 0;
            font-size: 1.1rem;
            color: var(--text-color);
        }


        /* Cast Grid Styles */
        #castGrid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            gap: 20px;
        }

        .cast-card {
            background-color: var(--card-bg-color);
            border-radius: 10px;
            box-shadow: var(--card-shadow);
            text-align: center;
            text-decoration: none;
            color: inherit;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            transition: transform 0.2s ease, box-shadow 0.2s ease;
        }
        
        body.dark-mode .cast-card {
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.5);
        }

        .cast-card:hover {
            transform: translateY(-5px);
            box-shadow: var(--card-hover-shadow);
        }

        body.dark-mode .cast-card:hover {
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.6);
        }

        .cast-card img {
            width: 100%;
            height: auto;
            aspect-ratio: 2 / 3;
            object-fit: cover;
        }

        .cast-card .name {
            padding: 15px 10px;
            font-weight: 600;
            font-size: 0.9em;
            flex-grow: 1;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        /* --- Responsive Layout --- */
        @media (max-width: 768px) {
            .app-header .container-fluid {
                padding: 0.75rem 0.5rem; 
            }
            .header-center-nav {
                flex-grow: 1; 
                justify-content: center; 
            }
            .nav-link {
                padding: 0.5rem 0.6rem; 
                font-size: 0.85rem;
            }
            .main-container {
                padding: 0 15px 15px 15px; 
            }
            #languageFilter {
                padding: 10px 15px; 
            }
            #castGrid {
                grid-template-columns: repeat(auto-fill, minmax(110px, 1fr));
                gap: 15px; 
            }
            .cast-card .name {
                padding: 8px 5px; 
                font-size: 0.8em; 
            }
        }
        
    </style>
</head>
<body>

    <header class="app-header">
        <div class="container-fluid d-flex align-items-center justify-content-between">
            
            <div class="logo-wrapper">
                <a id="logoLink" href="./index.html">
                    <img id="logo" src="./static/thiraiblack.png" alt="Thirai Logo" class="header-logo">
                </a>
            </div>
            
            <div class="d-flex align-items-center ms-auto">
                <div id="categoryNav" class="d-flex align-items-center gap-2 header-center-nav">
                    <a class="nav-link active" id="actorsBtn" href="#">Actors</a>
                    <a class="nav-link" id="actressesBtn" href="#">Actresses</a>
                </div>
            </div>
        </div>
    </header>

    <div id="languageFilter">
        </div>

    <main class="main-container">
        <div id="castGrid"></div>
    </main>
    
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            
            // --- START: JSON Data (UNCHANGED) ---
            const actorsData = [
                // Tamil Actors
                { "name": "Vijay", "tmdb_id": "91547", "actor_code": "3TKYioHCAF", "language": "tamil" }, 
                { "name": "Dhanush", "tmdb_id": "550165", "actor_code": "5vCobOqDDx", "language": "tamil" }, 
                { "name": "Kamal Haasan", "tmdb_id": "93193", "actor_code": "5Ix02sIDeA", "language": "tamil" },
                { "name": "Vijay Sethupathi", "tmdb_id": "1123766", "actor_code": "1yADiX9kkO", "language": "tamil" }, 
                { "name": "Rajinikanth", "tmdb_id": "91555", "actor_code": "ijsq87BV3Y", "language": "tamil" },
                { "name": "Karthi Sivakumar", "tmdb_id": "123066", "actor_code": "5mHRERsgQU", "language": "tamil" },
                { "name": "Sivakarthikeyan", "tmdb_id": "587982", "actor_code": "6ZDHHGuxxN", "language": "tamil" },
                { "name": "Vishal", "tmdb_id": "559892", "actor_code": "1emttPrIgB", "language": "tamil" },
                { "name": "Suriya", "tmdb_id": "85720", "actor_code": "2waH3hTKAe", "language": "tamil" },
                { "name": "Vikram", "tmdb_id": "93191", "actor_code": "5uf7csvvAf", "language": "tamil" },
                { "name": "Ajith Kumar", "tmdb_id": "148360", "actor_code": "4pDqQD0LPJ", "language": "tamil" },
                { "name": "Pradeep Ranganathan", "tmdb_id": "2274937", "actor_code": "19A9Wxsiru", "language": "tamil" },
                { "name": "M. G. Ramachandran", "tmdb_id": "584602", "actor_code": "8L6px81Vzd", "language": "tamil" },
                { "name": "Vijayakanth", "tmdb_id": "237635", "actor_code": "8huiZv1bPB", "language": "tamil" },
                { "name": "Prabhu", "tmdb_id": "85722", "actor_code": "5ycjeOX2Hm", "language": "tamil" },
                
                // Hindi Actors
                { "name": "Shah Rukh Khan", "tmdb_id": "35742", "actor_code": "b4tCNsNP3r", "language": "hindi" }, 
                { "name": "Ranbir Kapoor", "tmdb_id": "85034", "actor_code": "2cKAcgtako", "language": "hindi" }, 
                { "name": "Salman Khan", "tmdb_id": "42802", "actor_code": "73t49Zpm8Z", "language": "hindi" }, 
                { "name": "Sidharth Malhotra", "tmdb_id": "1108117", "actor_code": "2ZZHmp8rm2", "language": "hindi" }, 
                { "name": "Amitabh Bachchan", "tmdb_id": "35780", "actor_code": "2z1RmIZxHh", "language": "hindi" },
                { "name": "Hrithik Roshan", "tmdb_id": "78749", "actor_code": "pQrb67ZvoX", "language": "hindi" },
                { "name": "Aamir Khan", "tmdb_id": "52763", "actor_code": "7wg7uK17Bg", "language": "hindi" },
                
                // Malayalam Actors
                { "name": "Mohanlal", "tmdb_id": "82732", "actor_code": "1Uv6Det8Ej", "language": "malayalam" },   
                { "name": "Mammootty", "tmdb_id": "124111", "actor_code": "1WaoBhSG80", "language": "malayalam" }, 
                { "name": "Fahadh Fassil", "tmdb_id": "1072750", "actor_code": "5rqK8kvM2U", "language": "malayalam" },
                { "name": "Prithviraj", "tmdb_id": "117690", "actor_code": "4n085rJr74", "language": "malayalam" },
                
                // Telugu Actors
                { "name": "Prabhas", "tmdb_id": "237045", "actor_code": "7IcT9rmeui", "language": "telugu" },
                { "name": "Allu Arjun", "tmdb_id": "108215", "actor_code": "7ug2FmruQr", "language": "telugu" },
                { "name": "Nani", "tmdb_id": "225387", "actor_code": "3isSF2aCCr", "language": "telugu" }
            ];

            const actressesData = [
              // Actresses (assigned primary industry language)
              { "name": "Trisha Krishnan", "tmdb_id": "116925", "actor_code": "F1cHse9jWW", "language": "tamil" }, 
              { "name": "Samantha", "tmdb_id": "225312", "actor_code": "6WfqAcxel5", "language": "tamil" }, 
              { "name": "Asin", "tmdb_id": "81092", "actor_code": "F06ZXPJGJh", "language": "tamil" }, 
              { "name": "Nayanthara", "tmdb_id": "91548", "actor_code": "7tFt1Le1Ep", "language": "tamil" }, 
              { "name": "Pooja Hegde", "tmdb_id": "587753", "actor_code": "14CoLSwEXV", "language": "telugu" }, 
              { "name": "Alia Bhatt", "tmdb_id": "1108120", "actor_code": "4LJUx3vqDc", "language": "hindi" }, 
              { "name": "Nithya Menen", "tmdb_id": "225388", "actor_code": "3AQ1iONzZQ", "language": "tamil" }, 
              { "name": "Anushka Shetty", "tmdb_id": "88167", "actor_code": "2ldhTbiGgU", "language": "telugu" },
              { "name": "Hansika Motwani", "tmdb_id": "237967", "actor_code": "3FGflYSCcj", "language": "tamil" },
              { "name": "Kajal Aggarwal", "tmdb_id": "55061", "actor_code": "7GLAgNWiq2", "language": "hindi" },
              { "name": "Shruti Haasan", "tmdb_id": "85883", "actor_code": "7fCylLNfVi", "language": "tamil" },
              { "name": "Deepika Padukone", "tmdb_id": "53975", "actor_code": "7Iwku12HLv", "language": "hindi" },
              { "name": "Kareena Kapoor", "tmdb_id": "37233", "actor_code": "6cC1dMrY40", "language": "hindi" },
              { "name": "Priyamani", "tmdb_id": "1107197", "actor_code": "1mh1dheOZR", "language": "tamil" },
              { "name": "Simran", "tmdb_id": "141705", "actor_code": "33rNUL3JZx", "language": "tamil" },
              { "name": "Aishwarya Rajesh", "tmdb_id": "1114583", "actor_code": "CeT6162PqU", "language": "tamil" }
            ];
            
            // Global map for accessing data arrays
            const allCastData = {
                'actors': actorsData,
                'actresses': actressesData
            };
            
            // --- END: JSON Data ---

            // TMDb API Configuration
            const TMDB_API_KEY = '926e94b0f70b5bed8417b679652366ab';
            const TMDB_BASE_URL = 'https://api.themoviedb.org/3/person/';
            const TMDB_IMAGE_BASE_URL = 'https://image.tmdb.org/t/p/w185';
            
            // Element References
            const body = document.body;
            const logo = document.getElementById('logo');
            const castGrid = document.getElementById('castGrid');
            const actorsBtn = document.getElementById('actorsBtn');
            const actressesBtn = document.getElementById('actressesBtn');
            const logoLink = document.getElementById('logoLink');
            const languageFilterDiv = document.getElementById('languageFilter'); 

            // State Variables
            let currentCastType = 'actors'; 
            let activeLanguageFilter = 'all'; 


            // --- Utility Functions ---

            function adjustBodyPadding() {
                const header = document.querySelector('.app-header');
                const filter = document.getElementById('languageFilter');
                
                if (header && filter) {
                    const headerHeight = header.offsetHeight;
                    const filterHeight = filter.offsetHeight;
                    
                    // Filter bar's top position is set right below the fixed header
                    filter.style.top = `${headerHeight}px`;

                    // Main content starts below the fixed header AND the fixed filter bar + a little extra margin
                    const totalFixedHeight = headerHeight + filterHeight + 20; 
                    document.querySelector('.main-container').style.marginTop = `${totalFixedHeight}px`; 
                }
            }
            
            function updateThemeAssets(isDarkMode) {
                const lightLogo = './static/thiraiblack.png';
                const darkLogo = './static/thiraiwhite.png';
                logo.src = isDarkMode ? darkLogo : lightLogo;
            }

            function applyTheme(theme) {
                let isDarkMode;
                const storedTheme = localStorage.getItem('theme');

                if (theme === 'system' && storedTheme) {
                    theme = storedTheme;
                }
                
                if (theme === 'dark') {
                    body.classList.add('dark-mode');
                    isDarkMode = true;
                } else if (theme === 'light') {
                    body.classList.remove('dark-mode');
                    isDarkMode = false;
                } else { // System default
                    isDarkMode = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
                    if (isDarkMode) body.classList.add('dark-mode');
                    else body.classList.remove('dark-mode');
                }
                updateThemeAssets(isDarkMode);
            }
            
            function getUniqueLanguages(data) {
                const languages = new Set();
                data.forEach(member => {
                    if (member.language) {
                        languages.add(member.language);
                    }
                });
                return Array.from(languages).sort();
            }

            function updateActiveFilterButton(language) {
                 document.querySelectorAll('.language-filter-btn').forEach(btn => {
                    btn.classList.remove('active');
                    if (btn.dataset.language === language) {
                        btn.classList.add('active');
                    }
                });
            }
            
            function createLanguageFilter(castType) {
                languageFilterDiv.innerHTML = ''; 
                
                const availableLanguages = getUniqueLanguages(allCastData[castType]);

                // 1. Add 'All' button
                const allBtn = document.createElement('a');
                allBtn.className = 'language-filter-btn';
                allBtn.href = '#';
                allBtn.dataset.language = 'all';
                allBtn.textContent = 'All Languages';
                if (activeLanguageFilter === 'all') allBtn.classList.add('active');
                languageFilterDiv.appendChild(allBtn);

                // 2. Add language specific buttons
                availableLanguages.forEach(lang => {
                    // Capitalize first letter of each word (e.g., 'tamil' -> 'Tamil')
                    const capitalized = lang.charAt(0).toUpperCase() + lang.slice(1);
                    
                    const btn = document.createElement('a');
                    btn.className = 'language-filter-btn';
                    btn.href = '#';
                    btn.dataset.language = lang;
                    btn.textContent = capitalized;
                    if (activeLanguageFilter === lang) btn.classList.add('active');
                    
                    languageFilterDiv.appendChild(btn);
                });

                // 3. Attach event listeners 
                document.querySelectorAll('.language-filter-btn').forEach(btn => {
                    btn.addEventListener('click', (event) => {
                        event.preventDefault();
                        const selectedLang = event.currentTarget.dataset.language;
                        if (selectedLang !== activeLanguageFilter) {
                            activeLanguageFilter = selectedLang;
                            updateActiveFilterButton(selectedLang);
                            displayCast(currentCastType, activeLanguageFilter); 
                        }
                    });
                });
                
                // 4. Reset filter if the active one isn't available for the new cast type
                if (activeLanguageFilter !== 'all' && !availableLanguages.includes(activeLanguageFilter)) {
                    activeLanguageFilter = 'all';
                    updateActiveFilterButton('all');
                    displayCast(currentCastType, activeLanguageFilter);
                }
                
                // Re-adjust padding after filter content is created
                adjustBodyPadding();
            }


            async function fetchProfileImageUrl(tmdbId) {
                const url = `${TMDB_BASE_URL}${tmdbId}?api_key=${TMDB_API_KEY}&append_to_response=images`;
                
                try {
                    const response = await fetch(url);
                    if (!response.ok) {
                        return null; 
                    }
                    const data = await response.json();
                    const profilePath = data.profile_path; 
                    
                    if (profilePath) {
                        return `${TMDB_IMAGE_BASE_URL}${profilePath}`;
                    } else {
                        return null; 
                    }
                } catch (error) {
                    return null;
                }
            }

            function createCastCard(member, imageUrl) {
                 const card = document.createElement('a');
                 card.className = 'cast-card';
                 
                 const lang = member.language || 'tamil'; 
                 card.href = `actor.html?lang=${lang}&actor_id=${member.actor_code}`; 

                 const img = document.createElement('img');
                 img.src = imageUrl || './static/placeholder.png'; 
                 img.alt = `Photo of ${member.name}`;
                 img.loading = 'lazy';
                 
                 img.onerror = function() {
                    this.onerror=null; 
                    this.src='./static/default_actor.png'; 
                 };

                 const name = document.createElement('div');
                 name.className = 'name';
                 name.textContent = member.name;
                 
                 card.appendChild(img);
                 card.appendChild(name);
                 
                 return card;
            }

            async function displayCast(castType, languageFilter) {
                castGrid.innerHTML = ''; 
                let castList = allCastData[castType];
                currentCastType = castType; 

                // Apply language filter
                if (languageFilter && languageFilter !== 'all') {
                    castList = castList.filter(member => member.language === languageFilter);
                }

                if (castList.length === 0) {
                    castGrid.innerHTML = '<div class="loading-message">No cast members found for the selected filter.</div>';
                    return;
                }

                castGrid.innerHTML = '<div class="loading-message">Loading cast profiles...</div>'; 

                const fetchPromises = castList.map(member => 
                    fetchProfileImageUrl(member.tmdb_id).then(imageUrl => ({
                        member,
                        imageUrl
                    }))
                );

                const results = await Promise.all(fetchPromises);
                
                castGrid.innerHTML = ''; 

                const fragment = document.createDocumentFragment();

                results.forEach(result => {
                    const card = createCastCard(result.member, result.imageUrl);
                    fragment.appendChild(card);
                });
                
                castGrid.appendChild(fragment);
            }


            // --- Event Listeners for Toggle Buttons ---
            actorsBtn.addEventListener('click', (event) => {
                event.preventDefault();
                if (!actorsBtn.classList.contains('active')) {
                    currentCastType = 'actors';
                    activeLanguageFilter = 'all'; // Reset filter when switching category
                    actorsBtn.classList.add('active');
                    actressesBtn.classList.remove('active');
                    createLanguageFilter(currentCastType); 
                    displayCast(currentCastType, activeLanguageFilter);
                }
            });

            actressesBtn.addEventListener('click', (event) => {
                event.preventDefault();
                if (!actressesBtn.classList.contains('active')) {
                    currentCastType = 'actresses';
                    activeLanguageFilter = 'all'; // Reset filter when switching category
                    actressesBtn.classList.add('active');
                    actorsBtn.classList.remove('active');
                    createLanguageFilter(currentCastType); 
                    displayCast(currentCastType, activeLanguageFilter); 
                }
            });

            // --- Initialization ---
            
            const storedTheme = localStorage.getItem('theme') || 'system';
            applyTheme(storedTheme);
            
            if (window.matchMedia) {
                window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', event => {
                    if (!localStorage.getItem('theme')) applyTheme('system');
                });
            }

            // Load default cast and create initial filter
            createLanguageFilter(currentCastType);
            displayCast(currentCastType, activeLanguageFilter); 
            
            // Adjust body padding on load and resize
            adjustBodyPadding();
            window.addEventListener('resize', adjustBodyPadding);
        });
    </script>
</body>
</html>
